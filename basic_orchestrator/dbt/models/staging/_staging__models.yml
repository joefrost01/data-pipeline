version: 2

models:
  - name: stg_load_metadata
    description: |
      Staged load metadata with derived fields.
      
      Extracts feed_name and business_date from the filename.
      Calculates version_rank to identify the latest load per feed/date.
    columns:
      - name: load_id
        description: Unique load identifier
        tests:
          - unique
          - not_null
      - name: feed_name
        description: Stable feed identifier derived from filename
      - name: business_date
        description: Business date derived from filename or load time
      - name: is_latest
        description: True if this is the latest load for feed/date combo

  - name: stg_futures_order_events
    description: |
      Staged futures order events with proper typing.
      
      Grain: One row per event (same as raw)
      
      All string columns cast to appropriate types using safe casts.
      Joined to load metadata for lineage tracking.
    columns:
      - name: order_message_id
        description: Unique order identifier
        tests:
          - not_null
      - name: event_seq
        description: Event sequence number within order
        tests:
          - not_null
      - name: extract_date
        description: Date the data was extracted
      - name: _load_id
        description: Load batch identifier for lineage
